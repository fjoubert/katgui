<!DOCTYPE html>
<html ng-app="katGui">
<head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <link href="app/app.less" type="text/css" rel="stylesheet/less">
    <!-- endbuild -->
    <!--todo: using this base tag breaks relative paths for includes like css, js and images-->
    <!--figure that out before using the base element-->
    <!--<base href="/">-->
</head>

<!-- Place this asynchronous JavaScript just before your </body> tag -->
<!--<script type="text/javascript">-->
<!--(function () {-->
<!--var po = document.createElement('script');-->
<!--po.type = 'text/javascript';-->
<!--po.async = true;-->
<!--po.src = 'https://apis.google.com/js/client:plusone.js';-->
<!--var s = document.getElementsByTagName('script')[0];-->
<!--s.parentNode.insertBefore(po, s);-->
<!--})();-->
<!--</script>-->

<body ng-controller="ApplicationCtrl as vm" md-theme="{{themePrimary}}" md-theme-watch="true" layout="row" ng-cloak>

<!-- Livereload script for development only (stripped during dist build) -->
<script src="http://localhost:35729/livereload.js" data-build="exclude"></script>
<script src="bower_components/jquery/dist/jquery.min.js"></script>
<script src="bower_components/Sortable/Sortable.min.js"></script>

<!-- JS from Bower Components -->
<script src="bower_components/less.js/dist/less.min.js" data-build="exclude"></script>
<script src="bower_components/bootstrap/dist/js/bootstrap.js"></script>
<script src="bower_components/underscore/underscore.js"></script>
<script src="bower_components/moment/moment.js"></script>
<script src="bower_components/sockjs/sockjs.js"></script>
<script src="bower_components/angular/angular.js"></script>
<script src="bower_components/angular-aria/angular-aria.js"></script>
<script src="bower_components/angular-animate/angular-animate.js"></script>
<script src="bower_components/hammerjs/hammer.js"></script>
<script src="bower_components/angular-material/angular-material.js"></script>
<script src="bower_components/angular-mocks/angular-mocks.js"></script>
<script src="bower_components/angular-ui-router/release/angular-ui-router.js"></script>
<script src="bower_components/angular-resource/angular-resource.js"></script>
<script src="bower_components/angular-bootstrap/ui-bootstrap-tpls.js"></script>
<script src="bower_components/angular-ui-utils/ui-utils.js"></script>
<script src="bower_components/ngstorage/ngStorage.js"></script>
<script src="bower_components/angular-dashboard-framework/dist/angular-dashboard-framework.min.js"></script>
<script src="bower_components/angular-bootstrap-datetimepicker/src/js/datetimepicker.js"></script>
<script src="bower_components/jsjws/jws-3.0.js"></script>
<script src="bower_components/jsjws/ext/json-sans-eval-min.js"></script>
<script src="bower_components/jsrsasign/jsrsasign-4.7.0-all-min.js"></script>
<!--<script src="bower_components/angular-gantt/assets/angular-gantt.js"></script>-->
<!-- Add New Bower Component JS Above -->

<!-- Main App JS -->
<script src="app/services/alarms-service.js"></script>
<script src="app/services/control-service.js"></script>
<script src="app/services/config-service.js"></script>
<script src="app/services/data-service.js"></script>
<script src="app/services/monitor-service.js"></script>
<script src="app/services/sensors-service.js"></script>
<script src="app/services/observation-schedule-service.js"></script>
<script src="app/services/receptor-state-service.js"></script>
<script src="app/services/user-service.js"></script>
<script src="app/services/session-service.js"></script>
<script src="app/services/status-service.js"></script>

<script src="app/util/focus-directive.js"></script>
<script src="app/util/util.js"></script>

<script src="app/d3/compass-chart.js"></script>
<script src="app/d3/d3-gantt-chart.js"></script>
<script src="app/d3/multi-line-chart.js"></script>
<script src="app/d3/multi-line-two-y-axis-chart.js"></script>
<script src="app/d3/d3-service.js"></script>
<script src="app/d3/d3-util-service.js"></script>
<script src="app/d3/receptor-pointing-equatorial.js"></script>
<script src="app/d3/receptor-pointing-horizontal.js"></script>
<script src="app/d3/receptor-health-items.js"></script>
<script src="app/d3/receptor-health-tree-map.js"></script>
<script src="app/d3/receptor-health-pack-map.js"></script>
<script src="app/d3/receptor-health-partition-map.js"></script>
<script src="app/d3/receptor-health-icicle-map.js"></script>
<script src="app/d3/receptor-health-sunburst-map.js"></script>
<script src="app/d3/status-single-level-tree-map.js"></script>

<script src="app/app.js"></script>
<script src="app/about/about.js"></script>
<script src="app/config/config.js"></script>
<script src="app/login-form/login-form.js"></script>
<script src="app/landing/landing.js"></script>
<script src="app/weather/weather.js"></script>
<script src="app/video/video.js"></script>
<script src="app/operator-control/operator-control.js"></script>
<script src="app/health/health.js"></script>
<script src="app/health/receptor-health/receptor-health.js"></script>
<script src="app/health/receptor-status/receptor-status.js"></script>
<script src="app/health/receptor-pointing/receptor-pointing.js"></script>
<script src="app/health/custom-health/custom-health.js"></script>
<script src="app/sensor-graph/sensor-graph.js"></script>
<script src="app/sensor-list/sensor-list.js"></script>
<script src="app/admin/admin.js"></script>
<script src="app/alarms/alarms.js"></script>
<script src="app/alarms/alarms-notify.js"></script>
<script src="app/widgets/navigation/navigation-widget.js"></script>
<script src="app/widgets/gantt/gantt-widget.js"></script>
<script src="app/widgets/dashboard-structures.js"></script>
<script src="app/scheduler/scheduler-home.js"></script>
<script src="app/scheduler/schedule-block-drafts/schedule-block-drafts.js"></script>
<script src="app/scheduler/subarrays-draft-assignment/subarrays-draft-assignment.js"></script>
<script src="app/scheduler/subarray-resources/subarray-resources.js"></script>
<script src="app/scheduler/observations/observations-detail.js"></script>
<script src="app/scheduler/observations/observations-overview.js"></script>
<script src="app/process-control/process-control.js"></script>
<!-- Add New Component JS Above -->

<!--dont use md-whiteframe class because it leaves black artifacts on sidenav-->
<md-content layout="row" layout-fill>
    <md-sidenav md-theme="{{themeSecondary}}" ng-if="loggedIn" class="md-sidenav-left" md-component-id="left-sidenav" layout="column" style="box-shadow: 0px 8px 17px 1px rgba(0, 0, 0, 0.2);">
        <md-toolbar class="md-whiteframe-z1" md-theme-watch="true">
            <h1 class="md-toolbar-tools side-nav-title">katGUI</h1>
        </md-toolbar>
        <md-content class="md-content-padding" style="margin-top: 16px;">
            <md-list>
                <md-item>
                    <md-item-content class="menu-item" layout="row" layout-align="start center" ng-click="vm.sideNavStateGo('home')">
                        <span class="fa fa-home"></span>
                        <button>Home</button>
                    </md-item-content>
                </md-item>
                <md-item>
                    <md-item-content style="border-bottom: 1px solid #e5e5e5; padding-bottom: 8px;" class="menu-item" layout="row" layout-align="start center" ng-click="vm.sideNavStateGo('alarms')">
                        <span class="fa fa-warning"></span>
                        <button>Alarms</button>
                    </md-item-content>
                </md-item>
                <md-item>
                    <md-item-content style="margin-top: 8px; margin-bottom: 8px; padding-bottom: 8px; border-bottom: 1px solid #e5e5e5;" layout="column">
                        <div class="menu-item" layout="row" layout-align="start center" ng-click="vm.sideNavStateGo('health')">
                            <span class="fa fa-heart"></span>
                            <button>Health & State</button>
                        </div>
                        <div class="menu-item menu-item-indented" layout="row" layout-align="start center" ng-click="vm.sideNavStateGo('receptorStatus')">
                            <span class="fa fa-th"></span>
                            <button>Receptor Status</button>
                        </div>
                        <div class="menu-item menu-item-indented" layout="row" layout-align="start center" ng-click="vm.sideNavStateGo('receptorPointing')">
                            <span class="fa fa-crosshairs"></span>
                            <button>Receptor Pointing</button>
                        </div>
                        <div class="menu-item menu-item-indented" layout="row" layout-align="start center" ng-click="vm.sideNavStateGo('receptorHealth')">
                            <span class="fa fa-th-large"></span>
                            <button>Receptor Health</button>
                        </div>
                        <div class="menu-item" layout="row" layout-align="start center" ng-click="vm.sideNavStateGo('customHealth')">
                            <span class="fa fa-heartbeat"></span>
                            <button>Custom Health & State</button>
                        </div>
                    </md-item-content>
                </md-item>
                <md-item>
                    <md-item-content style="padding-bottom: 8px;" ng-click="vm.sideNavStateGo('operator-control')">
                        <div class="menu-item" layout="row" layout-align="start center">
                            <span class="fa fa-cogs"></span>
                            <button>Operator Control</button>
                        </div>
                    </md-item-content>
                </md-item>
                <md-item>
                    <md-item-content style="padding-bottom: 8px;" ng-click="vm.sideNavStateGo('process-control')">
                        <div style="border-bottom: 1px solid #e5e5e5;" class="menu-item" layout="row" layout-align="start center">
                            <span class="fa fa-wrench"></span>
                            <button>Process Control</button>
                        </div>
                    </md-item-content>
                </md-item>
                <md-item>
                    <md-item-content layout="column" style="margin-top: 8px; margin-bottom: 8px; padding-bottom: 8px; border-bottom: 1px solid #e5e5e5;">
                        <div class="menu-item" layout="row" layout-align="start center" ng-click="vm.sideNavStateGo('scheduler')">
                            <span class="fa fa-list"></span>
                            <button>Scheduler Management</button>
                        </div>
                        <div class="menu-item menu-item-indented" layout="row" layout-align="start center" ng-click="vm.sideNavStateGo('scheduler.drafts')">
                            <span class="fa fa-pencil"></span>
                            <button>Schedule Block Drafts</button>
                        </div>
                        <div class="menu-item menu-item-indented" layout="row" layout-align="start center" ng-click="vm.sideNavStateGo('scheduler.subarrays')">
                            <span class="fa fa-asterisk"></span>
                            <button>Sub-Arrays</button>
                        </div>
                        <div class="menu-item menu-item-indented" layout="row" layout-align="start center" ng-click="vm.sideNavStateGo('scheduler.resources')">
                            <span class="fa fa-sitemap"></span>
                            <button>Sub-Array Resources</button>
                        </div>
                        <div class="menu-item menu-item-indented" layout="row" layout-align="start center" ng-click="vm.sideNavStateGo('scheduler.observations')">
                            <span class="fa fa-binoculars"></span>
                            <button>Observations Overview</button>
                        </div>
                    </md-item-content>
                </md-item>
                <md-item>
                    <md-item-content class="menu-item" layout="row" layout-align="start center" ng-click="vm.sideNavStateGo('sensor-graph')">
                        <span class="fa fa-line-chart"></span>
                        <button>Sensor Graphs</button>
                    </md-item-content>
                </md-item>
                <md-item>
                    <md-item-content class="menu-item" layout="row" layout-align="start center" ng-click="vm.sideNavStateGo('sensor-list')"
                                     style="border-bottom: 1px solid #e5e5e5;">
                        <span class="fa fa-th-list"></span>
                        <button>Sensor List</button>
                    </md-item-content>
                </md-item>
                <md-item>
                    <md-item-content class="menu-item" layout="row" layout-align="start center" ng-click="vm.openCentralLogger()"
                                     style="border-bottom: 1px solid #e5e5e5;">
                        <span class="fa fa-file-text-o"></span>
                        <button>Central Logger</button>
                    </md-item-content>
                </md-item>
                <md-item>
                    <md-item-content class="menu-item" layout="row" layout-align="start center" ng-click="vm.sideNavStateGo('video')">
                        <span class="fa fa-video-camera"></span>
                        <button>Video</button>
                    </md-item-content>
                </md-item>
                <md-item>
                    <md-item-content class="menu-item" layout="row" layout-align="start center" ng-click="vm.sideNavStateGo('weather')">
                        <span class="fa fa-cloud"></span>
                        <button>Weather</button>
                    </md-item-content>
                </md-item>
                <md-item>
                    <md-item-content class="menu-item" layout="row" layout-align="start center" ng-click="vm.sideNavStateGo('about')">
                        <span class="fa fa-info"></span>
                        <button>About katGUI</button>
                    </md-item-content>
                </md-item>
            </md-list>
        </md-content>
    </md-sidenav>

    <md-sidenav md-theme="{{themeSecondary}}" ng-if="loggedIn" class="md-sidenav-right" md-component-id="right-sidenav" layout="column" style="box-shadow: 0px 8px 17px 1px rgba(0, 0, 0, 0.2);">
        <md-toolbar class="md-whiteframe-z1" md-theme-watch="true">
            <h1 class="md-toolbar-tools side-nav-title">User Navigation</h1>
        </md-toolbar>
        <md-content class="md-content-padding" style="margin-top: 16px;">
            <md-list>
                <md-item>
                    <md-item-content class="menu-item" layout="row" layout-align="start center" ng-click="vm.sideNavRightStateGo('admin')">
                        <span class="fa fa-users"></span>
                        <button>User Admin</button>
                    </md-item-content>
                </md-item>
                <md-item>
                    <md-item-content class="menu-item" layout="row" layout-align="start center" ng-click="vm.sideNavRightStateGo('config')">
                        <span class="fa fa-gear"></span>
                        <button>Configure katGUI</button>
                    </md-item-content>
                </md-item>
                <md-item>
                    <md-item-content class="menu-item-divider" layout="row" layout-align="start center">
                    </md-item-content>
                </md-item>
                <md-item>
                    <md-item-content class="menu-item" layout="row" layout-align="start center" ng-click="vm.logout()">
                        <span class="fa"></span>
                        <button>Logout</button>
                    </md-item-content>
                </md-item>
            </md-list>
        </md-content>
    </md-sidenav>

    <div layout="column" flex>
        <md-toolbar id="main-top-toolbar" ng-if="loggedIn" ng-show="vm.showNavbar" class="md-whiteframe-z1" md-theme-watch="true"
                    ng-class="{'slide-in-vertically-navbar': loggedIn, 'connection-lost-bg-bright': vm.connectionToMonitorLost}" >
            <div class="md-toolbar-tools" layout="row" style="padding: 0; max-height: 56px; min-height: 56px; overflow: hidden; margin-bottom: 16px;">

                <md-button class="md-icon-button mainbar-navbar-button" ng-click="vm.toggleLeftSidenav()">
                    <md-icon md-theme="white" class="fa md-primary" md-font-icon="fa-navicon"></md-icon>
                </md-button>

                <span style="font-size: 30px; cursor: pointer;" ng-click="vm.navigateToParentState()">{{vm.currentState()}}</span>
                <span flex></span>
                <div ng-show="showDayOfYear && vm.dayOfYear">
                    <span style="font-size: 32px;">{{vm.dayOfYear}}</span><span class="toolbar-time-span" style="font-size: 12px; margin-right: 8px;"> DoY</span>
                    <md-tooltip>Current UTC Day Of Year</md-tooltip>
                </div>
                <div ng-show="showDate && vm.currentDate">
                    <span style="font-size: 32px;">{{vm.currentDate}}</span><span class="toolbar-time-span" style="font-size: 12px; margin-right: 8px;"> Date</span>
                    <md-tooltip>Current UTC Date</md-tooltip>
                </div>
                <div ng-if="vm.julianDay" ng-show="showJulianDate">
                    <span style="font-size: 32px;">{{vm.julianDay}}</span><span class="toolbar-time-span" style="font-size: 12px; margin-right: 8px;"> JD</span>
                    <md-tooltip>Julian Day</md-tooltip>
                </div>
                <div ng-if="vm.localSiderealTime" ng-show="showLST">
                    <span style="font-size: 32px;">{{vm.localSiderealTime}}</span><span class="toolbar-time-span" style="font-size: 12px;margin-right: 8px;"> LST</span>
                    <md-tooltip>Local Sidereal Time</md-tooltip>
                </div>
                <div ng-if="vm.utcTime && showLocalAndSAST">
                    <span class="toolbar-time-span">{{vm.utcTime}}</span><span class="toolbar-time-span" style="font-size: 12px;"> UTC</span><br/>
                    <span class="toolbar-time-span">{{vm.localTime}}</span><span class="toolbar-time-span" style="font-size: 12px;"> SAST</span>
                </div>

                <md-button class="md-icon-button mainbar-navbar-button" ng-click="vm.stateGo('home')">
                    <md-icon md-theme="white" class="fa md-primary" md-font-icon="fa-home"></md-icon>
                </md-button>

                <md-button class="md-icon-button mainbar-navbar-button" style="overflow: visible;" ng-click="vm.stateGo('alarms')">
                    <md-icon md-theme="white" class="fa md-primary" md-font-icon="fa-warning"></md-icon>
                    <span title="Warning Alarms" ng-show="newAlarms"
                          class="badge alarm-badge alarm-badge-warn">{{newAlarms = (alarmsData | filter:{priority:'new'} | filter:{severity:'warn'}).length}}</span>
                    <span title="Error Alarms" ng-show="errorAlarms"
                          class="badge alarm-badge alarm-badge-error">{{errorAlarms = (alarmsData | filter:{priority:'new'} | filter:{severity:'error'}).length}}</span>
                    <span title="Critical Alarms" ng-show="critAlarms"
                          class="badge alarm-badge alarm-badge-crit">{{critAlarms = (alarmsData | filter:{priority:'new'} | filter:{severity:'critical'}).length}}</span>
                </md-button>

                <md-button class="mainbar-navbar-button md-icon-button"  ng-click="vm.toggleRightSidenav()">
                    <md-icon md-theme="white" class="fa md-primary" md-font-icon="fa-user"></md-icon>
                </md-button>
            </div>

        </md-toolbar>
        <md-content id="ui-view-container-div" ui-view flex class="md-content-padding" layout="column">
        </md-content>
    </div>

</md-content>
<div ng-if="loggedIn" class="unselectable toolbar-collapse-button" ng-class="{'toolbar-collapse-button-grey': !vm.showNavbar}"
        ng-click="vm.toggleNavbar()" title="Expand or Collapse Toolbar">
    <span class="fa"
       ng-class="{ 'fa-caret-up': vm.showNavbar, 'fa-caret-down': !vm.showNavbar}"></span>
</div>

<alarms-notifier ng-if="loggedIn"></alarms-notifier>
<!--this button is for d3 created buttons to be able to easily infer the current theme, but we do not need to display it-->
<md-button  id="btnPrimaryTheme" class="md-primary md-raised" md-theme="{{themePrimaryButtons}}" style="display: none"></md-button>

</body>
</html>
